<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Action Overview</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="/css/base.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.webui-popover/2.1.15/jquery.webui-popover.min.css">
</head>

<body oncontextmenu="return false" ondragstart="return false" onselectstart="return false">

    <div class="nav">
        <div class="logo"><a href="action.html" class="f-logo">HiStory</a></div>
        <ul class="menu">
            <li><a href="action.html" class="f-menu active">Action</a></li>
            <li><a href="history.html" class="f-menu">History</a></li>
            <li><a href="explore.html" class="f-menu">Explore</a></li>
            <li><a href="setting.html" class="f-menu">Setting</a></li>
        </ul>
    </div>

    <div class="container">
        <div class="left">
            <div class="left-top">
                <div class="view-mode">
                    <div class="overview"><a href="action.html" class="f-basic active">Overview</a></div>
                    <div class="timeline"><a href="/action-tl.html" class="f-basic ">Timeline</a></div>
                </div>
                <a href="#" class="f-basic arg">ARG</a>
                <div class="webui-popover-content">
                    <div class="arg-popover">
                        <button>이름 내림</button>
                        <button>이름 오름</button>
                        <button>날짜 오름</button>
                        <button>날짜 내림</button>
                        <button>사용자 지정</button>
                    </div>
                </div>
            </div>
            <div id="story_list" class="story-list">
                <div class="story">
                    <div class="story-header">
                        <div class="story-title"><a href="story.html" class="f-title">Story Title</a></div>
                        <a href="#" class="onoff"><img src="img/icon/ic_settings_black_24px.svg" border='0'></a>
                        <div class="webui-popover-content">
                            <div class="story-set-popover">
                                <button>NewMemo</button>
                                <button>Done</button>
                                <button>Delete</button>
                            </div>
                        </div>
                    </div>
                    <div class="memo">
                        <a href="#" class="edit f-sub">Edit</a>
                        <div class="story-memo">Lorem ipsum dolor sit amet, inventore?</div>
                    </div>
                    <div class="memo">
                        <a href="#" class="edit f-sub">Edit</a>
                        <div class="story-memo">MEMO Lorem ipsum dolor sit amet, consectetur adipisicing elit. Eaque libero ipsam hic quidem alias iure voluptate molestias. Distinctio aliquid, est. 가나다라 마바사 아자차카 타파하. 가나다라 마바사 아자차카 타파하. 가나다라 마바사 아자차카 타파하. 가나다라 마바사 아자차카 타파하. 가나다라 마바사 아자차카 타파하. 가나다라 마바사 아자차카 타파하. 가나다라 마바사 아자차카 타파하. 가나다라 마바사 아자차카 타파하. </div>
                    </div>
                </div>
                <!--자바코드-->
                <!--<% for(var i=0; i<data.length; i++) {%>-->
                <!--<div class="story">-->
                    <!--<div class="story-header">-->
                        <!--<div class='story-no' style='display:none'><%= data[i].Story_No %></div>-->
                        <!--<div class="story-title"><a href="/main/action/story/<%=data[i].Story_No%>" class="f-title"><%= data[i].Story_Title%></a></div>-->
                        <!--<a href="#" class="onoff"><img src="/img/icon/ic_settings_black_24px.svg" border="0"></a>-->
                        <!--<div class="webui-popover-content">-->
                            <!--<div class="story-set-popover">-->
                                <!--<button>NewMemo</button>-->
                                <!--<button>Done</button>-->
                                <!--<button>Delete</button>-->
                            <!--</div>-->
                        <!--</div>-->
                    <!--</div>-->
                    <!--<% for(var j=0; j<data[i].Story_Memo.length ; j++){%>-->
                    <!--<div class="memo">-->
                        <!--<a href="#" class="edit f-sub">Edit</a>-->
                        <!--<div class='story-memo-no' style='display: none'><%=data[i].Story_Memo[j].Story_Memo_No%></div>-->
                        <!--<div class="story-memo"><%=data[i].Story_Memo[j].Story_Memo_Text%></div>-->
                    <!--</div>-->
                    <!--<%}%>-->
                <!--</div>-->
                <!--<% }%>-->
            </div>
        </div>
        <div class="right">
            <div class="aside">
                <div class="infor">
                    <div class="book-name f-subSmall">Bookname</div>
                    <div class="story-name f-empha">Storyname</div>
                    <div class="date f-subSmall">2017.00.00</div>
                    <hr class="hr-infor">
                    <div class="score">
                        <div class="score-num citation f-subSmall">Citation
                            <div class="citation-num f-empha">6</div>
                        </div>
                        <div class="score-num follow f-subSmall">Follow
                            <div class="follow-num f-empha">8</div>
                        </div>
                        <div class="score-num view f-subSmall">View
                            <div class="view-num f-empha">670</div>
                        </div>
                    </div>
                    <hr class="hr-infor">
                    <div class="story-enter"><a href="/story.html" class="f-basic">ENTER</a></div>
                </div>
                <!--뉴스토리 만드는 버튼-->
                <div class="aside-btn">
                    <button id="new" class="f-basic">NEW STORY</button>
                </div>
            </div>
            <div class="footer f-subSmall">Company Infor</div>
        </div>

    <!--스토리 추가하는 팝업부분-->
    <!--TODO Action에서 스토리 추가하는 부분 구현, 가운데에는 북리스트가 떠서 선택한 북으로 저장, 이부분은 select로 구현 가능할듯-->
    <div class="closeup">
        <div class="new-story">
            <input type="text" id="new-story-title" placeholder="insert TITLE">
            <a id="new-story-close"><img src="/img/icon/ic_clear_black_24px.svg"></a>
            <!--여기에 북리스트 추가됨-->
            <div class="new-story-book">
            </div>
            <div class="new-story-footer">
                <input type="checkbox" id="public">
                <label for="public" class="f-subSmall">PUBLIC</label>
                <button id="insert-new-story" class="f-empha">SUBMIT</button>
            </div>
        </div>
        <!--스토리를 끝내는 부분-->
        <div class='story-done'>
            
        </div>
        <!--스토리를 지우는 부분-->
        <div class='story-delete'>
            <a href='#' id='story-delete-close'><img src='/img/icon/ic_clear_black_24px.svg'></a>
            <p class="del-nav">type "<span class="f-empha">story name을 삭제합니다.</span>"</p>
            <input type="text" id="confirm" placeholder="confirm massage">
            <input type="submit">
        </div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/jquery.webui-popover/2.1.15/jquery.webui-popover.min.js"></script>
    <script src="/js/popover.js"></script>
    <script src="/js/closeup.js"></script>
    <script src="http://ajax.microsoft.com/ajax/jquery.templates/beta1/jquery.tmpl.min.js"></script>

    <script id="booktemplate" type="text/x-tmpl">
        <input id="book_no" name="book_no" type="radio" value=${Book_No}>${Book_Name}
        <br>
    </script>

    <script>
        //TODO 템플릿 이쁘게 짜기, insert 구현하고, 폼으로 만들어서 radio로 구현
        $(".aside-btn").click(function () {
            $(".new-story-book").empty();
            $.ajax({
                url:"/main/list_book",
                type:"post",
//                headers: {"Authorization": "JWT "+localStorage.getItem("token")},
                success:function (data) {
                    $("#booktemplate").tmpl(data).appendTo(".new-story-book");
                }
            })

        });
//        TODO submit 버튼으로 안하고 작업함으로써 reload를 강제로 해줄것, 그리고 null값 처리도 해줄것
        $("#insert-new-story").click(function () {
            var data = {
                Story_Title : $("#new-story-title").val(),
                Book_No : $("#book_no").val(),
                Story_Public : !(!!$("#public").is(":checked"))
//                true 는 공개 false는 비공개
            };
            console.log(data);
            $.ajax({
                url:"/main/insert_story",
                type:"post",
                data:data,
//                headers: {"Authorization": "JWT "+localStorage.getItem("token")},
                success:function (data) {
                    console.log(data.message);

                }

            })
        })
    </script>

</body>

</html>
