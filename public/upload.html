<!DOCTYPE html>
<html>
<head>
    <title>Edit Page</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/jquery.webui-popover/2.1.15/jquery.webui-popover.min.js"></script>
    <script src="http://ajax.microsoft.com/ajax/jquery.templates/beta1/jquery.tmpl.min.js"></script>
</head>
<body>
<h1>Edit Page</h1>
<hr />
<form id="uploadform" action="upload" method="post" enctype="multipart/form-data">
    <fieldset>
        <legend>Edit Data</legend>
        <table>
            <tr>
                <td><label>BookName</label></td>
                <td><input id="bookname" type="text" name="bookname" /></td>
            </tr>
            <tr>
                <td><label>BookPublic</label></td>
                <td><input type="hidden" value="0" name="bookpublic" /></td>
                <td><input type="checkbox" value="1" name="bookpublic" /></td>
            </tr>
            <tr>
                <td><label>Book_Thumbnail</label></td>
                <td><input id="bookimg" type="file" name="bookimg" multiple/></td>
            </tr>
        </table>
        <input type="submit">업로딩</input>
    </fieldset>
</form>
</body>
</html>

<script>
    $('form').submit(function (event) {
        event.preventDefault();
        var formData = new FormData(this);

        $.ajax({
            url:'http://127.0.0.1:3000/main/upload',
            type:'post',
            processData: false,
            contentType:false,
            headers: {"Authorization": 'JWT '+localStorage.getItem('token')},
            data:formData,
            success:function () {
                alert('업로드 성공');
                window.location.href='/main';
            }
        })
    })
//    $('#uploading').click(function () {
//        var formData= new FormData();
//        formData.append("bookname",$('input[name=bookname]').val());
//        formData.append("bookimg",$('input[name=bookimg]')[0].files[0]);
//        console.log($('input[name=bookimg]')[0].files[0]);
//        console.log($('input[name=bookimg]')[0].files[1]);
//    });

</script>